---
interface FAQItem {
  question: string;
  answer: string;
}

interface Props {
  items: FAQItem[];
}

const { items = [] } = Astro.props;
---

<div class="space-y-3" data-faq-accordion>
  {items.map((item, index) => (
    <article class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl overflow-hidden">
      <button
        type="button"
        class="w-full flex items-center justify-between gap-4 p-5 text-left"
        data-faq-trigger
        aria-expanded={index === 0 ? 'true' : 'false'}
      >
        <h3 class="text-base md:text-lg font-extrabold text-slate-900 dark:text-white">{item.question}</h3>
        <span class="material-symbols-outlined text-slate-500 faq-icon">expand_more</span>
      </button>
      <div class:list={{ 'px-5 pb-5': true, hidden: index !== 0 }} data-faq-content>
        <p class="text-slate-600 dark:text-slate-400 leading-relaxed text-sm md:text-base">{item.answer}</p>
      </div>
    </article>
  ))}
</div>

<script>
  const accordions = document.querySelectorAll('[data-faq-accordion]');

  accordions.forEach((accordion) => {
    const triggers = accordion.querySelectorAll('[data-faq-trigger]');

    triggers.forEach((trigger) => {
      trigger.addEventListener('click', () => {
        const isExpanded = trigger.getAttribute('aria-expanded') === 'true';

        triggers.forEach((itemTrigger) => {
          itemTrigger.setAttribute('aria-expanded', 'false');
          const itemContent = itemTrigger.parentElement?.querySelector('[data-faq-content]');
          const icon = itemTrigger.querySelector('.faq-icon');
          itemContent?.classList.add('hidden');
          icon?.classList.remove('rotate-180');
        });

        if (!isExpanded) {
          trigger.setAttribute('aria-expanded', 'true');
          const content = trigger.parentElement?.querySelector('[data-faq-content]');
          const icon = trigger.querySelector('.faq-icon');
          content?.classList.remove('hidden');
          icon?.classList.add('rotate-180');
        }
      });
    });
  });
</script>
